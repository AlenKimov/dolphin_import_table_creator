# Dolphin import table creator
-> [Статья на teletype](https://teletype.in/@alenkimov/dolphin_import_table_creator)

В первую очередь нам нужно [скачать](https://www.python.org/downloads/) и установить Python.

Далее [скачиваем](https://github.com/AlenKimov/dolphin_import_table_creator/archive/refs/heads/main.zip) и распаковываем проект.

Для удобства в папке со скриптом создаем новую папку и перемещаем туда экспортированные `.txt` файлы *cookie*. Также рядом со скриптом помещаем файл с прокси (если используются). Прокси должны быть вида:
```
192.168.0.1:8000:login:password
или
login:password@host:port
```

Запускаем **start.bat**: этот файл установит отсутствующие библиотеки и запустит скрипт. На выходе получим нужный нам `.xlsx` файл. Удачного импорта!

## Запуск из командной строки
Также можно запустить из командной строки, указав значения параметров заранее:
```bash
python main.py -cp "cookies" -pp "proxies.txt" -pt "http" -st "ctime"
```

| Параметр            | Описание                                 |
| ------------------- | ---------------------------------------- |
| -pp, --proxies_path | Путь до файла с прокси                   |
| -cp, --cookies_path | Путь до папки с файлами *cookie*         |
| -pt, --proxy_type   | Тип прокси (http, https, socks5, ssh)    |
| -st, --sorting_type | Тип сортировки (ctime, mtime, name, num) |

## ToDo
- [x] Создание `.xlsx` файла
- [x] Заполнение по подобию *template* файла
- [x] Указание пути до папки с *cookie*
- [x] Указание пути до файла с прокси
- [x] Считывание данных 
	- [x] Считывание данных с файлов *cookie*
		- [x] Считывание имен профилей
		- [ ] Предупреждение о превышении лимита в 50k символов
	- [x] Считывание данных с файла с прокси
- [x] Указание типа прокси
- [x] Выбор сортировки
	- [x] По дате изменения файла
	- [x] По дате создания файла
	- [x] По имени файла
	- [x] По имени файла, если оно число
	- [ ] Обратная сортировка
- [x] Вывод предпросмотра в консоль
- [ ] Вернуть полный предпросмотр для прокси
- [x] Сохранение ключевых данных в *config.json*
- [x] Занесение данных в таблицу
- [x] Сохранение таблицы
	- [x] Проверка на то, открыта ли таблица в другой программе
---
- [x] `.bat` файл для запуска скрипта и установки отсутствующих библиотек
- [x] Интеграция *argparse*
